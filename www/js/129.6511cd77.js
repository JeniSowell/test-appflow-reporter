(self["webpackChunkreporter"]=self["webpackChunkreporter"]||[]).push([[129],{81411:(t,e,o)=>{"use strict";o.r(e),o.d(e,{default:()=>X});var a=o(83673),r=o(62323),i=o(39776),s=o.n(i);const n=(0,a._)("img",{src:s(),class:"sw-brand-icon"},null,-1),u=(0,a._)("span",{class:"sw-brand"},"SoWell",-1);function c(t,e,o,i,s,c){const l=(0,a.up)("q-toolbar-title"),h=(0,a.up)("q-toolbar"),p=(0,a.up)("q-btn"),d=(0,a.up)("q-header"),f=(0,a.up)("sync-required"),A=(0,a.up)("router-view"),g=(0,a.up)("q-page-container"),m=(0,a.up)("q-route-tab"),w=(0,a.up)("q-badge"),k=(0,a.up)("q-tabs"),Q=(0,a.up)("q-footer"),b=(0,a.up)("q-layout"),T=(0,a.Q2)("touch-hold");return(0,a.wg)(),(0,a.j4)(b,{view:"lHh Lpr lFf"},{default:(0,a.w5)((()=>[(0,a.Wm)(d,null,{default:(0,a.w5)((()=>[(0,a.Wm)(h,null,{default:(0,a.w5)((()=>[(0,a.Wm)(l,{class:"text-center"},{default:(0,a.w5)((()=>[n,u])),_:1})])),_:1}),(0,a.wy)((0,a.Wm)(p,{class:"absolute-right",flat:"",color:"secondary",onClick:c.logout,icon:"exit_to_app"},null,8,["onClick"]),[[T,c.reset,"3000"]])])),_:1}),(0,a.Wm)(g,null,{default:(0,a.w5)((()=>[(0,a.Wm)(f),(0,a.Wm)(A)])),_:1}),(0,a.Wm)(Q,null,{default:(0,a.w5)((()=>[(0,a.Wm)(k,{dense:"",position:"bottom",align:"center"},{default:(0,a.w5)((()=>[(0,a.Wm)(m,{label:"Signaler",icon:"send",to:"/categories",exact:""}),c.showControlButton?((0,a.wg)(),(0,a.j4)(m,{key:0,label:"ContrÃ´ler",icon:"check_circle_outline",to:"/zones",exact:""})):(0,a.kq)("",!0),(0,a.Wm)(m,{label:"Historique",icon:"history",to:"/history",exact:""},{default:(0,a.w5)((()=>[c.hasNotifications?((0,a.wg)(),(0,a.j4)(w,{key:0,floating:"",color:"negative"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,r.zw)(c.isManager?s.managerNotificationsCount:t.reporterNotificationsCount),1)])),_:1})):(0,a.kq)("",!0)])),_:1})])),_:1})])),_:1})])),_:1})}var l=o(5187),h=o(93617),p=o(86310);const d={components:{SyncRequired:l.Z},inject:["$DB"],data(){return{managerNotificationsCount:0}},computed:{...(0,h.Se)({reporterNotificationsCount:"reporter/notificationsCount",notifications:"reporter/notifications",audits:"audits/all",company:"company/attributes"}),showControlButton(){return this.company.allowUnplannedAudits?this.company.hasAudits:this.$helpers.decodeToken(this.$store.getters["reporter/token"]).roles.includes("checklister")},isManager(){const t=this.$helpers.decodeToken(this.$store.getters["reporter/token"]);return t.roles.includes("manager")},hasNotifications(){return this.isManager?this.managerNotificationsCount>0:this.reporterNotificationsCount>0}},methods:{async countNotifications(){const t=this.notifications.map((t=>t.id));await this.$DB.localIssues().find({selector:{"meta.id":{$in:t}}}).then((t=>{this.managerNotificationsCount=t.docs.length}))},logout(){p.Z.$emit("pauseQueue"),this.$store.dispatch("reporter/logout"),this.$router.push({path:"/login"})},reset(){p.Z.$emit("pauseQueue"),this.$DB.resetLocalDBs(this.$q.platform.is.capacitor),this.$store.dispatch("reporter/reset"),this.$router.push({path:"/login"})}},watch:{notifications:function(){this.countNotifications()}}};var f=o(74260),A=o(19214),g=o(53812),m=o(39570),w=o(13747),k=o(48240),Q=o(72652),b=o(41762),T=o(57547),N=o(42770),Z=o(69721),q=o(87281),S=o(7518),W=o.n(S);const C=(0,f.Z)(d,[["render",c]]),X=C;W()(d,"components",{QLayout:A.Z,QHeader:g.Z,QToolbar:m.Z,QToolbarTitle:w.Z,QBtn:k.Z,QPageContainer:Q.Z,QFooter:b.Z,QTabs:T.Z,QRouteTab:N.Z,QBadge:Z.Z}),W()(d,"directives",{TouchHold:q.Z})},39776:t=>{t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAJYAAADICAMAAAA9W+hXAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAYUExURQAAAOf4+fr+/vn+/ur5+fX8/e77+////9HhoGQAAAAHdFJOUwAm7NBQqX7rJeofAAAEZElEQVR42u1d0XLjIAxESIL//+OzL00aO2A7ZkGaDts+9cGzFssihHBDmJiYmJiY+Jsgl6Q4xuSNlOQHWGxjs+CNVMwvsF1o9EFAf5jRGyszXsQvBj9i2rDKmSxV9IAuf0l5BwtavKWQCrR0PKs9h0gfg2igLtpHZuXwQXU4Lf2glfcz8RFBc1r6obfxtDiXRnE/tB5orSTYmFZhEFd1iTGtVKKV9qIfTktKtD48Qjw4xP+ZZ0yLyqO4DZdB0sVl0ZMxrYroN3QN1upiuBZ1iemiWAnXTvQW2Wkse4T4SgSf4SJjWkWP2OYRIfgRPbnaZfx6hDGtoug3lmpTjqiFK9rSCpU8Qg1XnyuWqja0apbKxvURPRa9Fa1alsrG1aTKCqTGtI4tNVrRCiXRx+cctaNV9Aj5Eb0drXAk+mhXDNey6MWYVtFSn3sNw6MDPhD9MFprJV6SLL/PmnyqZKlxDC0S1f2AxaREFY/QASmESCwmfVU8kueupz+UvqP0G66OmU3i70k9ql0dacktTs+tWSda6S6pH0vtQks4N2DNI+Ign/wGa9rjR1Rv6iI4Lc3NWBZq8CASgNV/S4WuPhQRrNDzkDII0FgJihV05wOLFTQ7xcUKmdhQhsKRX/UIV8TSYleOhfaIC9LiF8ZZ6km0Ykr0nkzrINEf0YpcWOLoLKXmzpKX6gZkgKVqPde86SrST/NK98eeuy0+2mTDqY+6orStpdzH6C9qNvXOI/jeQ6V3Nvi7a43fjEDqnQ3S4pLrj9D9MFs3VZ6bceNcpHUBTmB3aRQ9vZ7JhJktCFqbF71NrGL3BAr/7fdTaNaVYHFHWgThXpArlVTUswT2hnctQoB6KIseRysjR1Ehgm+Z1eqTVoLRgnqgwBwCu+7Dlh/sxhP2jhlogb1pQaMV/xAt7S55/kO+5ZSWIHM37UzrZibInTOIe7SA+VZlw2KeJHHuu74qktaduQidPQFW02BkoZJQm3TC7qoTKFwRW0kSTJk4oSs2jBjGSgWi4Xxf651FzeWtlnMfQJ2YM1bwRwXG68KABPx6XV1Hvdd3j700jvU+k8aGFmo55aLvT9baw3U6EHrYJNgYrqMDy6MC9GFPXHtN/viIt3YiJd3Pqk/Od+NnAfrsTBjSwHXlXF8W0FrFX3B+to9pz7jaYMMXe1FRXbrYXhZcoxSyawTYGYjsk0L2f+N4YVsD2d8QAuUFvx5C7oSFk1eP6w7qTO4oeXW6atcqr14dBsmdsNrl1fMmbnTjoyB59W1dEXfCapFX/yve0ZuwbstryG1XcSb3u/Ia9dnH6GEpbJVXGIbkTljf8hr7UYroktVVeQ2/ny/uhHV952jxEZboTVgX5WX04Yc0eAeNWRztvoAcXbI6cgm7bx8fyiuYQp326LMfxzp1Lw7mEDc+ejaM4oHWh3v5YLU/aFcnrHY3NoIbqCPHKsvL1b8oEHfC2gxjDMEjL3///oIdOdZWXhocQjhMTExMTExMTExMNOEfjuvF5SSzklkAAAAASUVORK5CYII="}}]);